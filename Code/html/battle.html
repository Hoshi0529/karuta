<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>バトル画面</title>
    <link rel="stylesheet" href="../css/battle.css" type="text/css">
</head>
<body>
    
<div class="battle-container">
    <h1 id="nameDisplay"></h1><!-- ここに名前を表示 -->

    <div class="yomiagesan" ><!--読み上げのところ-->
        <p class="yomiagenagare"id="yomiage">sample</p>
    </div>

    <div class="seitousan" id="seitou"><p><p></div><!--正答-->

    <div class="score">
        <div class="scoresanp" id="scorep">*</div><!--プレイヤー点数-->
        <div class="scoresanc" id="scorec" >*</div><!--CPU点数-->
    </div>

    <div class="cardsup"><!--絵札1~6枚目-->
        <button class="ca1"id="cards1"><img id="cards1s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca2"id="cards2"><img id="cards2s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca3"id="cards3"><img id="cards3s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca4"id="cards4"><img id="cards4s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca5"id="cards5"><img id="cards5s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca6"id="cards6"><img id="cards6s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
    </div>

    <div class="carddo"><!--絵札7~11枚目-->
        <button class="ca7"id="cards7"><img id="cards7s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca8"id="cards8"><img id="cards8s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca9"id="cards9"><img id="cards9s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca10"id="cards10"><img id="cards10s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
        <button class="ca11"id="cards11"><img id="cards11s" src="/img/使わない.PNG" height ="130px" width="80px" /></button>
    </div>
</div>
<script>

// URLからクエリパラメータを取得
const urlParams = new URLSearchParams(window.location.search);
        const nameValue = urlParams.get('name');  // 'name'というパラメータの値を取得

        // 取得した値を表示
        document.getElementById('nameDisplay').textContent = nameValue;  // 取得した値を表示

const ary = ['赤べこは 幸せ呼ぶよ ゆらゆらと','猪苗代 白鳥舞い降り 冬の朝','梅干しを 塩と日差しが 熟成す','笑顔咲く 桃の甘さに 春を知る','大内宿 江戸の名残に 時忘れ','かんぴょうを 巻く手のひらに 春の風','喜多方の 麺が呼んでる あの香り','くじらなみ くろがねやまに くもかかる','けんぱくで 歴史を知ろう 福の島','こおりやま だるまの目入れ 願い込め','酒どころ 米と湧き水 絶品だ','しらかわの しずかなやまに しぐれふる','すいぎょくの すながわながる すみのさと','世界呼ぶ ももりんブランド 甘い桃','相馬野馬追 勇士の姿 語り継ぐ','滝桜 千年超える 春の夢','ちょうじゃまち ちくじゅのもりに ちょうひびく','鶴ヶ城 四季の彩り 心打つ','天鏡湖 湖に映す 空と山','とうじばに ともしびゆれる とわのゆめ','なみえ焼き サクっと香ばし 名物だ','二本松 菊が彩る 秋の町','ぬれつばさ ぬさをささげ ぬまのさと','根岸焼 素朴で渋い 器たち','野口英世 偉人を讃える 猪苗代','磐梯の 湖に映る 五色沼','白虎隊 若き魂 今もなお','福が舞う 赤べこの首 ゆらゆらと','平伏沼 秋の夕陽が 紅を映す','保原町 梨とぶどうの 甘い里','万葉の 梅が香るよ 月の宿','みしらずの 甘い柿には 秋が来る','昔話 会津の里に 残る影','めはりずし 山里の味 懐かしく','燃ゆる秋 紅葉の山が 見せる夢','矢祭町 森に広がる 癒やしの場','雪深く 山と温泉 織りなす地','夜明け前 磐梯映る 湖面の空','らくようの 松茸香る 会津山','量多し 夏はこれだね ぜんまいや','瑠璃色の 湖が広がる 桧原湖','歴史ある 二本松城の 石垣よ','路地に咲く 山茶花揺れる 冬の町','若松の 米が紡いだ 酒の味','をかしさよ 郷土の民話 味わえば'];

var picary =["/img/あ.PNG","/img/い.PNG","/img/う.PNG","/img/え.PNG","/img/お.PNG",
             "/img/か.PNG","/img/き.PNG","/img/く.PNG","/img/け.PNG","/img/こ.PNG",
             "/img/さ.PNG","/img/し.PNG","/img/す.PNG","/img/せ.PNG","/img/そ.PNG",
             "/img/た.PNG","/img/ち.PNG","/img/つ.PNG","/img/て.PNG","/img/と.PNG",
             "/img/な.PNG","/img/に.PNG","/img/ぬ.PNG","/img/ね.PNG","/img/の.PNG",
             "/img/は.PNG","/img/ひ.PNG","/img/ふ.PNG","/img/へ.PNG","/img/ほ.PNG",
             "/img/ま.PNG","/img/み.PNG","/img/む.PNG","/img/め.PNG","/img/も.PNG",
             "/img/や.PNG","/img/ゆ.PNG","/img/よ.PNG",
             "/img/ら.PNG","/img/り.PNG","/img/る.PNG","/img/れ.PNG","/img/ろ.PNG",
             "/img/わ.PNG","/img/を.PNG"];

var cardsn=[];//選ばれた絵札入れとく配列
let num;
let playerscore=0;//プレイヤーの点数
let cpuscore =0;//CPUの点数
let res='';//勝敗
let miss=0;//お手付きの回数
var cpuact =Boolean('');
var cnt=0;
var yomiagen=0;
const yomiager=[];
for(let i =0;i<11;i++)//絵札を重複なしで11枚選ぶ
{
    num=Math.floor(Math.random()*45);
    for(let j=0;j<=i;j++)
    {
        if(num===cardsn[j])//同じやつがあったらリセット
        {
            num=Math.floor(Math.random()*45);
            j=0;
        }
    }
    cardsn[i]=num;
    switch(i)//絵札並べる
    {
        case 0:
        //document.getElementById('cards1').textContent=ary[num];
        document.getElementById('cards1s').src=picary[num];
        break;
        case 1:
        //document.getElementById('cards2').textContent=ary[num];
        document.getElementById('cards2s').src=picary[num];
        break;
        case 2:
        //document.getElementById('cards3').textContent=ary[num];
        document.getElementById('cards3s').src=picary[num];
        break;
        case 3:
        //document.getElementById('cards4').textContent=ary[num];
        document.getElementById('cards4s').src=picary[num];
        break;
        case 4:
        //document.getElementById('cards5').textContent=ary[num];
        document.getElementById('cards5s').src=picary[num];
        break;
        case 5:
        //document.getElementById('cards6').textContent=ary[num];
        document.getElementById('cards6s').src=picary[num];
        break;
        case 6:
        //document.getElementById('cards7').textContent=ary[num];
        document.getElementById('cards7s').src=picary[num];
        break;
        case 7:
        //document.getElementById('cards8').textContent=ary[num];
        document.getElementById('cards8s').src=picary[num];
        break;
        case 8:
        //document.getElementById('cards9').textContent=ary[num];
        document.getElementById('cards9s').src=picary[num];
        break;
        case 9:
        //document.getElementById('cards10').textContent=ary[num];
        document.getElementById('cards10s').src=picary[num];
        break;
        case 10:
        //document.getElementById('cards11').textContent=ary[num];
        document.getElementById('cards11s').src=picary[num];
        break;
    }
}
 
//😆😆😆😆😆😆😆😆😆😆😆読み札のとこここだよ😆😆😆😆😆😆😆😆😆😆😆😆😆😆
let restcards=11;//残り枚数
//game start! 아파트, 아파트 아파트, 아파트 아파트, 아파트 Uh, uh-huh, uh-huh///////////////////////////////////////////////////////////////////
 
    const doyomiage = () =>//読み札抽選関数
    {
        if(restcards>0)//残り札があるので継続
        {
            yomiagen = Math.floor(Math.random()*11);
            for(let i=0;i<yomiager.length;i++){
                if(yomiagen==yomiager[i]){
                    continue;
                }
            }
            yomiager[cnt]=yomiagen;
            cnt+=1;
            /*if(yomiagen==11)//から札よむかも
            {
                yomiagen = Math.floor(Math.random()*45);
                document.getElementById('yomiage').textContent=ary[yomiagen];
            }
            else//読み札の中からランダム
            {*/
                document.getElementById('yomiage').textContent=ary[cardsn[yomiagen]];
            //}
/////////////////////////////////////////////////////CPUの処理//////////////////////////////////////////////////////////////////////////////

        const cpuaction = function()
        {
            clearTimeout(timeiD);
            for(let i=0;i<10;i++)
            {
                if(document.getElementById('yomiage').textContent==ary[cardsn[i]])//正解の札を捜索
                {
                    var ote=Math.floor(Math.random()*5);//0~4
                    /*if(ote==4)//お手付きさせる
                    {
                        if(i>=5){i=i-3;}
                        else    {i=i+3;}
                    }*/
                    cpuact='t';//これはCPUのアクションですよ
                        switch(i)
                        {
                            case 0:cardcheck1c();break;
                            case 1:cardcheck2c();break;
                            case 2:cardcheck3c();break;
                            case 3:cardcheck4c();break;
                            case 4:cardcheck5c();break;
                            case 5:cardcheck6c();break;
                            case 6:cardcheck7c();break;
                            case 7:cardcheck8c();break;
                            case 8:cardcheck9c();break;
                            case 9:cardcheck10c();break;
                            case 10:cardcheck11c();break;
                        }
                        break;
                }
                
            }
        }
        var timeiD =setTimeout(cpuaction,5000)//5秒後にCPUが動き始めるよ
        }
        else//取りきったので勝敗判定
        {
            document.getElementById('yomiage').textContent='終了！';
            setTimeout(hantei,2000);
        }
    }
    const hantei=function(){
            if(playerscore>cpuscore)//勝ち
            {
                res='勝利';
                const url = `./result.html?name=${encodeURIComponent(res+':'+miss)}`;
                location.href = url;  
            }
            else if(playerscore<cpuscore)//負け
            {
                res='負け';
                const url = `./result.html?name=${encodeURIComponent(res+':'+miss)}`;
                location.href = url;
            }
            else//引き分け
            {
                res='引き分け';
                const url = `./result.html?name=${encodeURIComponent(res+':'+miss)}`;
                location.href = url;  
            }
            }
            if(restcards==11)//1回目だけこれで呼び出し
            {
                doyomiage();
            }

////////////////////////////////////////////////////////ここからしばらく正誤判定//////////////////////////////////////////////
    const cardcheck1 = () =>
    {
        if(cardsn[0]==cardsn[yomiagen])//正解
        //document.getElementById('cards1s').textContent===document.getElementById('yomiage').textContent
        {
            document.getElementById('cards1s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck2 = () =>
    {
        if(cardsn[1]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards2s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck3 = () =>
    {
        if(cardsn[2]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards3s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck4 = () =>
    {
        if(cardsn[3]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards4s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck5 = () =>
    {
        if(cardsn[4]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards5s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck6 = () =>
    {
        if(cardsn[5]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards6s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck7 = () =>
    {
        if(cardsn[6]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards7s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck8 = () =>
    {
        if(cardsn[7]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards8s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck9 = () =>
    {
        if(cardsn[8]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards9s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck10 = () =>
    {
        if(cardsn[9]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards10s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }
    const cardcheck11 = () =>
    {
        if(cardsn[10]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards11s').src="/img/裏.PNG";
            correct();
        }
        else//おてつき
        {
            incorrect();
        }
    }

    const cardcheck1c = () =>
    {
        if(cardsn[0]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards1s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck2c = () =>
    {
        if(cardsn[1]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards2s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck3c = () =>
    {
        if(cardsn[2]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards3s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck4c = () =>
    {
        if(cardsn[3]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards4s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck5c = () =>
    {
        if(cardsn[4]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards5s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck6c = () =>
    {
        if(cardsn[5]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards6s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck7c = () =>
    {
        if(cardsn[6]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards7s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck8c = () =>
    {
        if(cardsn[7]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards8s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck9c = () =>
    {
        if(cardsn[8]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards9s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck10c = () =>
    {
        if(cardsn[9]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards10s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }
    const cardcheck11c = () =>
    {
        if(cardsn[10]==cardsn[yomiagen])//正解
        {
            document.getElementById('cards11s').src="/img/裏.PNG";
            correctc();
        }
        else//おてつき
        {
            incorrectc();
        }
    }

    const correct = () =>{
        playerscore+=1;
        document.getElementById("scorep").textContent=playerscore;
        document.getElementById('seitou').textContent=restcards;//残り枚数みてるだけ
        restcards-=1;
        doyomiage();
    }
    const incorrect = () =>{
        miss+=1;
        //document.getElementById('seitou').textContent='おてつき';
        document.getElementById('seitou').textContent=restcards;
        doyomiage();
    }
    const correctc = () =>{
        cpuscore+=1;
        document.getElementById("scorec").textContent=cpuscore;
        restcards-=1;
        document.getElementById('seitou').textContent=restcards;
        doyomiage();
    }
    const incorrectc = () =>{
        document.getElementById('seitou').textContent=restcards;
        doyomiage();
    }
    document.getElementById('cards1s').addEventListener('click',cardcheck1)
    document.getElementById('cards2s').addEventListener('click',cardcheck2)
    document.getElementById('cards3s').addEventListener('click',cardcheck3)
    document.getElementById('cards4s').addEventListener('click',cardcheck4)
    document.getElementById('cards5s').addEventListener('click',cardcheck5)
    document.getElementById('cards6s').addEventListener('click',cardcheck6)
    document.getElementById('cards7s').addEventListener('click',cardcheck7)
    document.getElementById('cards8s').addEventListener('click',cardcheck8)
    document.getElementById('cards9s').addEventListener('click',cardcheck9)
    document.getElementById('cards10s').addEventListener('click',cardcheck10)
    document.getElementById('cards11s').addEventListener('click',cardcheck11)
////////////////////////////////////////////////////////正誤判定終わり////////////////////////////////////////////

</script>
</div>
</body>
</html>